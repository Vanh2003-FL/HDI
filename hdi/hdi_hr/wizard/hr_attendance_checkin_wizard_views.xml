<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Check In/Out Wizard Form -->
    <record id="view_hr_attendance_checkin_wizard_form" model="ir.ui.view">
        <field name="name">hr.attendance.checkin.wizard.form</field>
        <field name="model">hr.attendance.checkin.wizard</field>
        <field name="arch" type="xml">
            <form string="Chấm công">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="attendance_mode" widget="radio" 
                                   options="{'horizontal': true}"/>
                        </h1>
                    </div>
                    
                    <group>
                        <group>
                            <field name="employee_id" readonly="1"/>
                            <field name="work_location_id" 
                                   options="{'no_create': True, 'no_create_edit': True}"/>
                            <field name="last_attendance_info" readonly="1"/>
                        </group>
                        <group>
                            <field name="latitude" 
                                   placeholder="Ví dụ: 21.028511"
                                   help="Nhập tọa độ GPS hoặc để trống nếu làm từ xa"/>
                            <field name="longitude" 
                                   placeholder="Ví dụ: 105.804817"
                                   help="Nhập tọa độ GPS hoặc để trống nếu làm từ xa"/>
                        </group>
                    </group>
                    
                    <group>
                        <field name="note" placeholder="Ghi chú thêm (nếu có)..."/>
                    </group>
                    
                    <div class="alert alert-info" role="alert" 
                         invisible="attendance_mode != 'check_in' or can_check_in">
                        <i class="fa fa-info-circle"/> Bạn đã Check In rồi. Vui lòng Check Out trước khi Check In lại.
                    </div>
                    
                    <div class="alert alert-info" role="alert" 
                         invisible="attendance_mode != 'check_out' or can_check_out">
                        <i class="fa fa-info-circle"/> Bạn chưa Check In. Vui lòng Check In trước khi Check Out.
                    </div>
                    
                    <field name="can_check_in" invisible="1"/>
                    <field name="can_check_out" invisible="1"/>
                    <field name="current_attendance_id" invisible="1"/>
                </sheet>
                <footer>
                    <button name="action_process" 
                            string="Check In" 
                            type="object" 
                            class="btn-primary"
                            invisible="attendance_mode != 'check_in' or not can_check_in"/>
                    <button name="action_process" 
                            string="Check Out" 
                            type="object" 
                            class="btn-primary"
                            invisible="attendance_mode != 'check_out' or not can_check_out"/>
                    <button string="Hủy" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Check In Action -->
    <record id="action_hr_attendance_check_in" model="ir.actions.act_window">
        <field name="name">Check In</field>
        <field name="res_model">hr.attendance.checkin.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{
            'default_attendance_mode': 'check_in',
        }</field>
    </record>
    
    <!-- Check Out Action -->
    <record id="action_hr_attendance_check_out" model="ir.actions.act_window">
        <field name="name">Check Out</field>
        <field name="res_model">hr.attendance.checkin.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{
            'default_attendance_mode': 'check_out',
        }</field>
    </record>
    
    <!-- Quick Check In/Out Action (Auto detect) -->
    <record id="action_hr_attendance_quick_checkin" model="ir.actions.act_window">
        <field name="name">Chấm công</field>
        <field name="res_model">hr.attendance.checkin.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

</odoo>
