<?xml version="1.0" encoding="utf-8"?>
<templates xml:space="preserve">
    
    <!-- Enhanced My Attendances Template with Location Dropdown -->
    <t t-name="hdi_hr_attendance_enhanced.MyAttendancesEnhanced" t-inherit="hr_attendance.MyAttendances" t-inherit-mode="extension">
        
        <!-- Add location dropdown before greeting -->
        <xpath expr="//div[hasclass('o_hr_attendance_employee')]" position="before">
            <div class="hdi_location_selector mb-3">
                <t t-if="state.locations.length > 0">
                    <div class="form-group">
                        <label for="work_location_select" class="fw-bold">
                            <i class="fa fa-map-marker me-1"/> Địa điểm làm việc
                        </label>
                        <select 
                            id="work_location_select"
                            class="form-select form-select-lg"
                            t-model="state.selectedLocationId"
                            t-on-change="onLocationChange">
                            <option value="">-- Chọn địa điểm --</option>
                            <t t-foreach="state.locations" t-as="location" t-key="location.id">
                                <option 
                                    t-att-value="location.id"
                                    t-att-selected="location.id === state.selectedLocationId">
                                    <t t-esc="location.name"/>
                                    <t t-if="location.address"> - <t t-esc="location.address"/></t>
                                </option>
                            </t>
                        </select>
                        <small class="text-muted">
                            Vui lòng chọn địa điểm làm việc của bạn trước khi chấm công
                        </small>
                    </div>
                </t>
            </div>
        </xpath>
        
        <!-- Add processing indicator -->
        <xpath expr="//div[hasclass('o_hr_attendance_button_container')]" position="before">
            <div t-if="state.isProcessing" class="text-center mb-3">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Đang xử lý...</span>
                </div>
                <p class="text-muted mt-2">Đang ghi nhận chấm công...</p>
            </div>
        </xpath>
        
        <!-- Add offline indicator -->
        <xpath expr="//div[hasclass('o_hr_attendance_employee')]" position="after">
            <div t-if="!navigator.onLine" class="alert alert-warning mt-2">
                <i class="fa fa-wifi-slash me-2"/>
                <strong>Chế độ Offline:</strong> Chấm công sẽ được lưu tạm và đồng bộ khi có mạng.
            </div>
        </xpath>
        
    </t>
    
    <!-- Enhanced Kiosk Mode Template -->
    <t t-name="hdi_hr_attendance_enhanced.KioskModeEnhanced" t-inherit="hr_attendance.KioskMode" t-inherit-mode="extension">
        
        <!-- Customize greeting message -->
        <xpath expr="//h1[hasclass('o_hr_attendance_kiosk_welcome')]" position="replace">
            <h1 class="o_hr_attendance_kiosk_welcome text-center mb-4">
                <i class="fa fa-hand-wave me-2" style="color: #FFA500;"/>
                Xin chào!
            </h1>
        </xpath>
        
    </t>

</templates>
