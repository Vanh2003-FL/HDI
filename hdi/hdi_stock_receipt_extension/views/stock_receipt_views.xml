<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Tree View -->
    <record id="view_stock_receipt_tree" model="ir.ui.view">
        <field name="name">Danh sách phiếu nhập kho</field>
        <field name="model">stock.receipt</field>
        <field name="arch" type="xml">
            <list string="Danh sách phiếu nhập kho" decoration-info="state == 'qc'" decoration-success="state == 'done'">
                <field name="name" string="Mã phiếu nhập kho"/>
                <field name="receipt_date" string="Ngày nhập kho"/>
                <field name="picking_id" string="Phiếu điều chuyển"/>
                <field name="container_no" string="Số container"/>
                <field name="customs_declaration_no" string="Số tờ khai hải quan"/>
                <field name="qc_status" string="Trạng thái QC" widget="badge" decoration-warning="qc_status == 'pending'" decoration-success="qc_status == 'passed'" decoration-danger="qc_status == 'failed'"/>
                <field name="state" string="Trạng thái" widget="badge" decoration-success="state == 'done'" decoration-info="state == 'qc'"/>
            </list>
        </field>
    </record>

    <!-- Form View -->
    <record id="view_stock_receipt_form" model="ir.ui.view">
        <field name="name">Chi tiết phiếu nhập kho</field>
        <field name="model">stock.receipt</field>
        <field name="arch" type="xml">
            <form string="Chi tiết phiếu nhập kho">
                <header>
                    <button name="action_start_qc" string="Bắt đầu QC" type="object" class="oe_highlight" invisible="state != 'draft' or not qc_required"/>
                    <button name="action_qc_pass" string="QC đạt" type="object" class="oe_highlight" invisible="state != 'qc'"/>
                    <button name="action_qc_fail" string="QC không đạt" type="object" class="btn-danger" invisible="state != 'qc'"/>
                    <button name="action_done" string="Hoàn thành" type="object" class="oe_highlight" invisible="state not in ['draft', 'approved']"/>
                    <button name="action_cancel" string="Huỷ" type="object" invisible="state in ['done', 'cancel']"/>
                    <button name="action_draft" string="Chuyển về nháp" type="object" invisible="state != 'cancel'"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,qc,approved,done"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="picking_id" string="Phiếu điều chuyển"/>
                            <field name="warehouse_id" string="Kho nhập"/>
                            <field name="receipt_date" string="Ngày nhập kho"/>
                            <field name="company_id" string="Công ty" groups="base.group_multi_company"/>
                        </group>
                        <group>
                            <field name="vehicle_no" string="Số xe"/>
                            <field name="driver_name" string="Tên tài xế"/>
                            <field name="driver_phone" string="SĐT tài xế"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Thông tin container">
                            <group>
                                <group>
                                    <field name="container_no" string="Số container"/>
                                    <field name="container_type" string="Loại container"/>
                                    <field name="seal_no" string="Số seal"/>
                                </group>
                                <group>
                                    <field name="bill_of_lading" string="Vận đơn"/>
                                </group>
                            </group>
                        </page>

                        <page string="Thông tin hải quan">
                            <group>
                                <group>
                                    <field name="customs_declaration_no" string="Số tờ khai hải quan"/>
                                    <field name="customs_date" string="Ngày khai báo"/>
                                </group>
                                <group>
                                    <field name="import_license" string="Giấy phép nhập khẩu"/>
                                </group>
                            </group>
                        </page>

                        <page string="Kiểm tra chất lượng">
                            <group>
                                <group>
                                    <field name="qc_required" string="Yêu cầu QC"/>
                                    <field name="qc_status" string="Trạng thái QC"/>
                                    <field name="qc_date" string="Ngày QC"/>
                                </group>
                                <group>
                                    <field name="qc_user_id" string="Nhân viên QC"/>
                                </group>
                            </group>
                            <field name="qc_notes" string="Ghi chú QC" placeholder="Ghi chú kiểm tra chất lượng..."/>
                        </page>

                        <page string="Chi tiết batch nhập kho">
                            <field name="batch_line_ids">
                                <list editable="bottom" string="Danh sách batch nhập kho">
                                    <field name="sequence" string="STT" widget="handle"/>
                                    <field name="product_id" string="Sản phẩm"/>
                                    <field name="lot_id" string="Batch/Lot"/>
                                    <field name="lot_name" string="Tên batch/lot"/>
                                    <field name="quantity" string="Số lượng"/>
                                    <field name="uom_id" string="Đơn vị tính"/>
                                    <field name="package_no" string="Số kiện"/>
                                    <field name="pallet_no" string="Số pallet"/>
                                    <field name="manufacturing_date" string="Ngày sản xuất"/>
                                    <field name="expiry_date" string="Hạn sử dụng"/>
                                    <field name="qc_result" string="Kết quả QC" widget="badge"/>
                                    <field name="qc_remarks" string="Ghi chú QC"/>
                                </list>
                            </field>
                        </page>

                        <page string="Ghi chú">
                            <field name="notes" string="Ghi chú" placeholder="Ghi chú bổ sung..."/>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- Action -->
    <record id="action_stock_receipt" model="ir.actions.act_window">
        <field name="name">Danh sách phiếu nhập kho</field>
        <field name="res_model">stock.receipt</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Tạo mới phiếu nhập kho
            </p>
            <p>
                Quản lý chi tiết thông tin nhập kho, container, hải quan, kiểm tra chất lượng.
            </p>
        </field>
    </record>
</odoo>
