<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Barcode Scanner Wizard View -->
    <record id="view_barcode_scanner_wizard_form" model="ir.ui.view">
        <field name="name">stock.picking.barcode.scanner.form</field>
        <field name="model">stock.picking.barcode.scanner</field>
        <field name="arch" type="xml">
            <form string="üì± Qu√©t Barcode">
                <header>
                    <field name="state" widget="statusbar" statusbar_visible="scan_batch,scan_products,confirm"/>
                </header>
                <sheet>
                    <field name="picking_id" invisible="1"/>
                    <field name="scan_detail_level" invisible="1"/>
                    <field name="scan_complete" invisible="1"/>
                    
                    <!-- Message Display -->
                    <div class="oe_title">
                        <field name="message" widget="html" nolabel="1"/>
                    </div>
                    
                    <!-- Barcode Input -->
                    <group invisible="state == 'confirm'">
                        <field name="current_barcode" 
                               placeholder="Qu√©t ho·∫∑c nh·∫≠p barcode t·∫°i ƒë√¢y..."
                               class="o_scanner_input"
                               style="font-size: 20px; font-weight: bold;"/>
                    </group>
                    
                    <!-- Batch Info -->
                    <group string="üì¶ Th√¥ng tin Batch" invisible="not batch_id">
                        <group>
                            <field name="batch_id" readonly="1"/>
                            <field name="scanned_batch_barcode" readonly="1" string="M√£ QR"/>
                        </group>
                        <group>
                            <field name="expected_qty" readonly="1" string="S·ªë l∆∞·ª£ng d·ª± ki·∫øn"/>
                            <field name="total_scanned_qty" readonly="1" string="ƒê√£ qu√©t"/>
                        </group>
                    </group>
                    
                    <!-- Scanned Products List -->
                    <notebook invisible="not scanned_product_ids">
                        <page string="üìã Danh s√°ch ƒë√£ qu√©t" name="scanned_products">
                            <field name="scanned_product_ids" nolabel="1">
                                <list editable="bottom" create="false" delete="true">
                                    <field name="product_id" readonly="1"/>
                                    <field name="barcode" readonly="1"/>
                                    <field name="quantity"/>
                                    <field name="lot_id" optional="hide"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="action_complete" 
                            string="‚úÖ Ho√†n th√†nh" 
                            type="object" 
                            class="btn-primary"
                            invisible="not scan_complete"/>
                    <button string="‚ùå H·ªßy" special="cancel" class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Action to open scanner wizard -->
    <record id="action_open_barcode_scanner" model="ir.actions.act_window">
        <field name="name">Qu√©t Barcode</field>
        <field name="res_model">stock.picking.barcode.scanner</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{
            'default_picking_id': active_id,
        }</field>
    </record>
    
</odoo>
