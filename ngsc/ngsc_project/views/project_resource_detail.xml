<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="resource_planning_form_inherit" model="ir.ui.view">
        <field name="name">en.resource.detail.form.inherit</field>
        <field name="inherit_id" ref="ngsd_base.resource_planning_form"/>
        <field name="priority">99999999</field>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <button name="button_en_cancel"
                        string="Hủy"
                        type="object"
                        class="btn-secondary"
                        attrs="{'invisible':[('state','!=','draft')]}"/>
            </xpath>
             <xpath expr="//sheet/notebook/page/field[@name='order_line']/tree" position="attributes">
                 <attribute name="default_order">project_stage_id desc, employee_id asc,date_start asc</attribute>
                 <attribute name="class">allow_list_copy grouped_by_stage</attribute>
            </xpath>
            <xpath expr="//sheet/notebook/page/field[@name='order_line']/tree/field[@name='en_state']" position="after">
                <field name="can_copy" invisible="1"/>
                <field name="date_start" invisible="1"/>
                <field name="date_end" invisible="1"/>
                <field name="project_stage_code" invisible="1"/>
                <button name="open_split_confirm_popup" type="object" icon="fa-scissors"
                        help="Tách dòng này"
                        attrs="{'invisible': ['|', ('id', '=', False), ('can_copy', '=', False)]}"/>
            </xpath>
             <xpath expr="//field[@name='state']" position="attributes">
                <attribute name="statusbar_visible">draft,to_approve,to_wbs_approve,approved</attribute>
             </xpath>
            <xpath expr="//field[@name='write_uid']" position="after">
                <field name="wbs_link_resource_planning" readonly="0" force_save="1" domain="[('project_id', '=', project_id)]"/>
             </xpath>
            <xpath expr="//sheet/notebook/page/field[@name='order_line']/tree/field[@name='project_stage_id']" position="replace"/>

            <xpath expr="//sheet/notebook/page/field[@name='order_line']/tree/field[@name='type_id']" position="before">
                <field name="project_stage_id" options="{'no_open':True,'no_create':True,'no_quick_create':True,'no_create_edit':True}" required="1"/>
            </xpath>

            <xpath expr="//field[@name='order_line']" position="attributes">
                <attribute name="class">grouped_by_stage</attribute>
                <attribute name="widget">one2many_grouped_stage</attribute>
             </xpath>
        </field>
    </record>
</odoo>
