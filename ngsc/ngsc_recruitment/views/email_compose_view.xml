<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- View tùy biến cho form gửi email -->
        <record id="ngsc_recruitment_email_compose_form" model="ir.ui.view">
            <field name="name">mail.compose.message.form.custom</field>
            <field name="model">mail.compose.message</field>
            <field name="arch" type="xml">
                <form string="Gửi email cho ứng viên" class="o_mail_composer_form">
                    <sheet>
                        <group>
                            <!-- Các trường ẩn để điều khiển logic -->
                            <field name="composition_mode" invisible="1"/>
                            <field name="model" invisible="1"/>
                            <field name="res_id" invisible="1"/>
                            <field name="is_log" invisible="1"/>
                            <field name="parent_id" invisible="1"/>
                            <field name="mail_server_id" invisible="1"/>
                            <field name="active_domain" invisible="1"/>
                            <field name="can_edit_body" invisible="1"/>
                            <field name="has_existing_booking" invisible="1"/>
                            <field name="formatted_interview_time" invisible="1"/>
                        </group>

                        <group string="Thông tin phỏng vấn"
                               colspan="2" col="2"
                               attrs="{'invisible': [('has_existing_booking', '=', True)]}">
                            <field name="interview_name"
                                   placeholder="Nhập tên buổi phỏng vấn"
                                   required="1"/>
                            <field name="interview_room_id"
                                   placeholder="Chọn phòng phỏng vấn"
                                   required="1"/>
                            <field name="interview_start"
                                   placeholder="Chọn thời gian bắt đầu"
                                   required="1"/>
                            <field name="interview_stop"
                                   placeholder="Chọn thời gian kết thúc"
                                   required="1"/>
                        </group>

                        <!-- Người nhận -->
                        <group string="Thông tin email">
                            <field name="partner_ids"
                                   widget="many2many_tags_email"
                                   placeholder="Thêm ứng viên hoặc liên hệ..."
                                   context="{'force_email': True, 'show_email': True}"
                                   required="1"/>
                            <field name="subject"
                                   placeholder="Nhập tiêu đề..."
                                   required="1"/>
                        </group>

                        <!-- Nội dung email -->
                        <field name="body"
                               class="oe-bordered-editor"
                               options="{'style-inline': true}"
                               attrs="{'readonly': [('can_edit_body', '=', False)]}"
                               placeholder="Nội dung email..."
                               force_save="1"/>

                        <!-- File đính kèm + Template email -->
                        <group col="4">
                            <field name="attachment_ids"
                                   widget="many2many_binary"
                                   string="Tệp đính kèm"
                                   nolabel="1"
                                   colspan="2"/>
                            <field name="template_id"
                                   options="{'no_create': True}"
                                   string="Sử dụng mẫu"
                                   context="{'default_model': model, 'default_body_html': body, 'default_subject': subject}"/>
                        </group>
                    </sheet>

                    <footer>
                        <button name="action_send_mail"
                                string="Gửi"
                                type="object"
                                class="btn-primary o_mail_send"/>
                        <button string="Đóng"
                                special="cancel"
                                class="btn-secondary"/>
                        <button icon="fa-lg fa-save"
                                name="action_save_as_template"
                                string="Lưu mẫu mới"
                                type="object"
                                attrs="{'invisible': [('can_edit_body', '=', False)]}"
                                class="float-right btn-secondary"/>
                    </footer>
                </form>
            </field>
        </record>
    </data>
</odoo>