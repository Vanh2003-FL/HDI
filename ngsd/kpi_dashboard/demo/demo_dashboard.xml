<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="demo_dashboard" model="kpi.dashboard">
        <field name="name">Dashboard</field>
        <field name="number_of_columns">7</field>
        <field name="widget_dimension_y">60</field>
        <field name="widget_dimension_x">250</field>
        <field name="background_color">#FFFFFF</field>
        <field name="compute_on_fly_refresh">30</field>
    </record>
    <record id="widget_year_user" model="kpi.kpi">
        <field name="name">Chỉ tiêu năm</field>
        <field name="computation_method">code</field>
        <field name="widget">number</field>
        <field name="code">emp = self.env.user.employee_ids[:1]
result = {"value": emp.target_year, "apply_date": {"string":"Áp dụng", "start_date": "", "end_date": ""}}
if emp.start_date_year:
    result["apply_date"]["start_date"] = emp.start_date_year.strftime('%d/%m/%Y')
if emp.end_date_year:
    result["apply_date"]["end_date"] = emp.end_date_year.strftime('%d/%m/%Y')
        </field>
    </record>
    <record id="widget_quarter_user" model="kpi.kpi">
        <field name="name">Chỉ tiêu quý</field>
        <field name="computation_method">code</field>
        <field name="widget">number</field>
        <field name="code">emp = self.env.user.employee_ids[:1]
result = {"value": emp.target_quarter, "apply_date": {"string":"Áp dụng", "start_date": "", "end_date": ""}}
if emp.start_date_quarter:
    result["apply_date"]["start_date"] = emp.start_date_quarter.strftime('%d/%m/%Y')
if emp.end_date_quarter:
    result["apply_date"]["end_date"] = emp.end_date_quarter.strftime('%d/%m/%Y')</field>
    </record>
    <record id="widget_performance_year" model="kpi.kpi">
        <field name="name">%KPI/năm</field>
        <field name="suffix">%</field>
        <field name="computation_method">code</field>
        <field name="widget">meter</field>
        <field name="code">emp = self.env.user.employee_ids[:1]
total_revenue = emp.get_revenue_year()
result = {"value": total_revenue, "value_max": emp.target_year, "meter_title": "Doanh thu"}</field>
    </record>
    <record id="widget_performance_quarter" model="kpi.kpi">
        <field name="name">%KPI/quý</field>
        <field name="suffix">%</field>
        <field name="computation_method">code</field>
        <field name="widget">meter</field>
        <field name="code">emp = self.env.user.employee_ids[:1]
total_revenue = emp.get_revenue_quarter()
result = {"value": total_revenue, "value_max": emp.target_quarter, "meter_title": "Doanh thu"}</field>
    </record>

    <record id="widget_graph" model="kpi.kpi">
        <field name="name">Doanh thu theo tháng</field>
        <field name="computation_method">code</field>
        <field name="widget">graph</field>
        <field
            name="code"
        ><![CDATA[
data = []
for i in range(1, 12):
    data.append({"label": str(i), "value": sum(self.env['crm.lead'].search([('user_id', '=', self.env.user.id), ('date_deadline', '>=', date.today().replace(day=1, month=i)), ('date_deadline', '<', date.today().replace(day=1, month=i+1))]).mapped('total_revenue'))})
data.append({"label": str(12), "value": sum(self.env['crm.lead'].search([('user_id', '=', self.env.user.id), ('date_deadline', '>=', date.today().replace(day=1, month=12)), ('date_deadline', '<', date.today().replace(day=31, month=12))]).mapped('total_revenue'))})
result = {"graphs": [
    {
        "values": data,
        "title": "Current Year",
        "key": "VND",
        "area": True,
        "color": "#4c78a8",
    }
],
'title': 'Tháng'
}
        ]]></field>
    </record>

    <record id="dashboard_widget_text" model="kpi.dashboard.item">
        <field name="name">Chỉ tiêu doanh thu</field>
        <field name="dashboard_id" ref="demo_dashboard" />
        <field name="column">1</field>
        <field name="row">1</field>
        <field name="size_x">6</field>
        <field name="color">#707070</field>
        <field name="font_color">#000000</field>
    </record>
    <record id="dashboard_widget_year_user" model="kpi.dashboard.item">
        <field name="name">Chỉ tiêu năm</field>
        <field name="dashboard_id" ref="demo_dashboard" />
        <field name="kpi_id" ref="widget_year_user" />
        <field name="column">1</field>
        <field name="row">2</field>
        <field name="size_y">4</field>
        <field name="color">#47bbb3</field>
        <field name="font_color">#ffffff</field>
    </record>
    <record id="dashboard_widget_quarter_user" model="kpi.dashboard.item">
        <field name="name">Chỉ tiêu quý</field>
        <field name="dashboard_id" ref="demo_dashboard" />
        <field name="kpi_id" ref="widget_quarter_user" />
        <field name="column">1</field>
        <field name="row">6</field>
        <field name="size_y">4</field>
        <field name="color">#ec663c</field>
        <field name="font_color">#ffffff</field>
    </record>
    <record id="dashboard_widget_performance_year" model="kpi.dashboard.item">
        <field name="name">%KPI/năm</field>
        <field name="dashboard_id" ref="demo_dashboard" />
        <field name="kpi_id" ref="widget_performance_year" />
        <field name="column">2</field>
        <field name="row">2</field>
        <field name="size_y">4</field>
        <field name="color">#9c4274</field>
        <field name="font_color">#ffffff</field>
    </record>
    <record id="dashboard_widget_performance_quarter" model="kpi.dashboard.item">
        <field name="name">%KPI/quý</field>
        <field name="dashboard_id" ref="demo_dashboard" />
        <field name="kpi_id" ref="widget_performance_quarter" />
        <field name="column">2</field>
        <field name="row">6</field>
        <field name="size_y">4</field>
        <field name="color">#12b0c5</field>
        <field name="font_color">#ffffff</field>
    </record>
    <record id="dashboard_widget_graph" model="kpi.dashboard.item">
        <field name="name">Doanh thu theo tháng</field>
        <field name="dashboard_id" ref="demo_dashboard" />
        <field name="kpi_id" ref="widget_graph" />
        <field name="column">3</field>
        <field name="row">2</field>
        <field name="size_x">4</field>
        <field name="size_y">8</field>
        <field name="color">#47bbb3</field>
        <field name="font_color">#ffffff</field>
    </record>
</odoo>
