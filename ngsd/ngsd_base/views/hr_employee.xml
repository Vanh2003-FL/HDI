<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Commented out for Odoo 18 compatibility - hr_holidays module renamed to hr_leave -->
    <!-- <record id="hr_holidays.act_hr_employee_holiday_request" model="ir.actions.server">
        <field name="binding_model_id"></field>
    </record>
    <record id="hr_holidays.action_hr_holidays_by_employee_and_type_report" model="ir.actions.server">
        <field name="binding_model_id"></field>
    </record> -->

    <record id="view_employee_filter_inherit" model="ir.ui.view">
      <field name="name">hr.employee.search.inherit</field>
      <field name="model">hr.employee</field>
      <field name="inherit_id" ref="hr.view_employee_filter"/>
      <field name="priority">30000</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='name']" position="attributes">
          <attribute name="filter_domain">['|', '|', ('work_email', 'ilike', self), ('name', 'ilike', self), ('barcode', 'ilike', self)]</attribute>
        </xpath>
        <xpath expr="//field[@name='name']" position="before">
          <field name="name" string='Tất cả'
            filter_domain="['|', '|','|', '|','|', '|','|', '|', ('barcode', 'ilike', self), ('name', 'ilike', self), ('work_email', 'ilike', self), ('phone', 'ilike', self), ('job_title', 'ilike', self), ('en_area_id', 'ilike', self), ('en_block_id', 'ilike', self) , ('department_id', 'ilike', self), ('en_department_id', 'ilike', self)]"/>
          <field name="barcode"/>
          <field name="name"/>
          <field name="work_email"/>
          <field name="phone"/>
          <field name="job_title"/>
          <field name="en_area_id"/>
          <field name="en_block_id"/>
          <field name="department_id"/>
          <field name="en_department_id"/>
        </xpath>
        <!-- Commented out for Odoo 18 compatibility - filter may not exist -->
        <!-- <xpath expr="//filter[@name='newly_hired_employee']" position="attributes">
            <attribute name="invisible">1</attribute>
        </xpath> -->
        <!-- Commented out for Odoo 18 compatibility - filters may not exist -->
        <!-- <xpath expr="//filter[@name='with_contract_warning']" position="before">
            <filter string="Hoạt động" name="active" domain="[('active', '=', True)]"/>
            <filter string="Nghỉ" name="inactive" domain="[('en_status', '=', 'inactive'), ('active', 'in', [True, False])]"/>
            <filter string="Nghỉ dài hạn" name="semi-inactive" domain="[('en_status', '=', 'semi-inactive')]"/>
        </xpath> -->
        <!-- <xpath expr="//filter[@name='group_manager']" position="after">
            <filter name="group_by_en_type_id" string="Loại" domain="[]" context="{'group_by': 'en_type_id'}"/>
            <filter name="group_by_en_area_id" string="Khu vực" domain="[]" context="{'group_by': 'en_area_id'}"/>
            <filter name="group_by_en_block_id" string="Khối" domain="[]" context="{'group_by': 'en_block_id'}"/>
        </xpath> -->
      </field>
    </record>

    <record id="hr_leave_view_form_inherit" model="ir.ui.view">
      <field name="name">hr.leave.form</field>
      <field name="model">hr.leave</field>
      <field name="inherit_id" ref="hr_holidays.hr_leave_view_form"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='supported_attachment_ids']" position="after">
          <field name="leave_code" invisible="1"/>
          <field name="create_uid" invisible="1"/>
          <field name="advance_leave"/>
          <field name="project_id" invisible="leave_code != 'W'" readonly="state not in ('draft',)"/>
        </xpath>
        <xpath expr="//group" position="after">
          <notebook>
            <page string="Thông tin phê duyệt">
              <group>
                <group>
                  <field name="en_request_user_id"/>
                  <field name="en_next_approver_ids" widget="many2many_tags"/>
                </group>
                <group>
                  <field name="en_request_date"/>
                  <field name="reason_refused" invisible="state != 'refuse'"/>
                </group>
              </group>
              <field name="en_approve_line_ids"/>
            </page>
          </notebook>

        </xpath>
        <!-- Commented out for Odoo 18 compatibility - buttons may not exist or have different names -->
        <!--
        <xpath expr="//button[@name='action_confirm']" position="attributes">
            <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//button[@name='action_approve']" position="attributes">
            <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//button[@name='action_refuse']" position="attributes">
            <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//button[@name='action_draft']" position="attributes">
            <attribute name="invisible">can_reset == False</attribute>
        </xpath>
        -->
        <xpath expr="//field[@name='holiday_status_id']" position="attributes">
          <attribute name="readonly">state not in ['draft']</attribute>
        </xpath>
        <xpath expr="//field[@name='supported_attachment_ids']" position="attributes">
          <attribute name="invisible">leave_type_support_document == False or state not in ('draft',)</attribute>
        </xpath>
        <xpath expr="//field[@name='number_of_days']" position="attributes">
          <attribute name="readonly">1</attribute>
        </xpath>
        <xpath expr="//group[@name='col_left']/div" position="replace">
          <div>
            <field name="date_from" invisible="1" widget="daterange"/>
            <field name="date_to" invisible="1"/>
            <field name="use_leave_time_slot" invisible="1"/>
            <div class="o_row o_row_readonly">
              <span class="oe_inline" invisible="request_unit_half or request_unit_hours">
                Từ
              </span>
              <field name="request_date_from" class="oe_inline" nolabel="1" readonly="state not in ('draft',)" required="not date_from or not date_to"/>
              <span class="oe_inline" invisible="request_unit_half or request_unit_hours">
                Đến
              </span>
              <field name="request_date_to" class="oe_inline" readonly="state not in ('draft',)" invisible="request_unit_half or request_unit_hours" required="not date_from or not date_to"/>
              <field name="request_date_from_period" class="oe_inline" string="In" options="{'horizontal': True}" readonly="state not in ('draft',)" required="request_unit_half"
                invisible="not request_unit_half"/>
              <field name="time_slot" options="{'horizontal': True}" readonly="state not in ('draft',)" required="use_time_slot" invisible="not use_time_slot"/>
            </div>
            <div class="o_row o_row_readonly oe_edit_only" style="margin-left: -2px;">
              <field name="request_unit_half" readonly="state not in ('draft',)" invisible="leave_type_request_unit == 'day'"/>
              <label for="request_unit_half" invisible="leave_type_request_unit == 'day'"/>
              <field name="request_unit_hours" readonly="state not in ('draft',)" invisible="leave_type_request_unit != 'hour' or use_leave_time_slot" class="ml-5"/>
              <label for="request_unit_hours" invisible="leave_type_request_unit != 'hour' or use_leave_time_slot"/>
              <field name="use_time_slot" readonly="state not in ('draft',)" invisible="leave_type_request_unit != 'hour' or not use_leave_time_slot" class="ml-5"/>
              <label for="use_time_slot" invisible="leave_type_request_unit != 'hour' or not use_leave_time_slot"/>
              <field name="request_unit_custom" invisible="1" readonly="state not in ('draft',)" class="ml-5"/>
              <label for="request_unit_custom" invisible="1"/>
            </div>
            <div class="o_row o_row_readonly">
              <label for="request_hour_from" string="Từ" invisible="not request_unit_hours"/>
              <field name="request_hour_from" force_save="1" readonly="use_time_slot or state == 'validate'" required="request_unit_hours" invisible="not request_unit_hours" widget="float_time"/>
              <label for="request_hour_to" string="Đến" invisible="not request_unit_hours"/>
              <field name="request_hour_to" force_save="1" readonly="use_time_slot or state == 'validate'" required="request_unit_hours" invisible="not request_unit_hours" widget="float_time"/>
            </div>
          </div>
        </xpath>

        <xpath expr="//field[@name='name']" position="attributes">
          <attribute name="readonly">state not in ('draft',)</attribute>
          <attribute name="required">1</attribute>
        </xpath>

        <!--                <xpath expr="//sheet" position="inside">-->
        <!--                    <field name="leave_manager_id" string="Người phê duyệt"/>-->
        <!--                </xpath>-->
        <xpath expr="//header" position="inside">
          <field name="sent_ok" invisible="1"/>
          <field name="approve_ok" invisible="1"/>
          <button string="Gửi duyệt" type="object" class="btn-primary" name="button_to_approve" invisible="state != 'draft' or not sent_ok"/>
          <button string="Duyệt" type="object" class="btn-primary" name="button_approved" invisible="state != 'confirm' or not approve_ok"/>
          <button string="Từ chối" type="object" name="button_refused" invisible="state != 'confirm' or not approve_ok"/>
        </xpath>
      </field>
    </record>
    <record id="hr_leave_view_form_popup_inherit" model="ir.ui.view">
      <field name="name">hr.leave.form</field>
      <field name="model">hr.leave</field>
      <field name="inherit_id" ref="hr_holidays.hr_leave_view_form"/>
      <field name="mode">primary</field>
      <field name="priority">10000</field>
      <field name="arch" type="xml">
        <xpath expr="//header" position="inside">
          <field name="sent_ok" invisible="1"/>
          <field name="approve_ok" invisible="1"/>
          <button string="Gửi duyệt" type="object" class="btn-primary" name="button_to_approve" invisible="state != 'draft' or not sent_ok"/>
          <button string="Duyệt" type="object" class="btn-primary" name="button_approved" invisible="state != 'confirm' or not approve_ok"/>
          <button string="Từ chối" type="object" name="button_refused" invisible="state != 'confirm' or not approve_ok"/>
        </xpath>
        <xpath expr="//header" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>

        <xpath expr="//form/sheet" position="after">
          <footer>
            <button string="Gửi duyệt" type="object" class="btn-primary" name="button_to_approve" invisible="state != 'draft' or not sent_ok"/>
            <button string="Duyệt" type="object" class="btn-primary" name="button_approved" invisible="state != 'confirm' or not approve_ok"/>
            <button string="Từ chối" type="object" name="button_refused" invisible="state != 'confirm' or not approve_ok"/>
            <button string="Lưu" type="object" class="btn-primary" name="button_only_save" invisible="state != 'draft'"/>
            <button string="Đóng" class="btn-default" special="cancel"/>
          </footer>
        </xpath>
      </field>
    </record>
    <record id="ngs_hr_leave_view_dashboard" model="ir.ui.view">
      <field name="name">ngs_hr_leave_view_dashboard</field>
      <field name="model">hr.leave</field>
      <field name="inherit_id" ref="hr_holidays.hr_leave_view_dashboard"/>
      <field name="arch" type="xml">
        <xpath expr="//calendar" position="attributes">
          <attribute name="form_view_id">%(hr_leave_view_form_popup_inherit)d</attribute>
        </xpath>
      </field>
    </record>

    <record id="hr_leave_view_search_manager_inherit" model="ir.ui.view">
      <field name="name">hr.leave.view.search.manager</field>
      <field name="model">hr.leave</field>
      <field name="inherit_id" ref="hr_holidays.hr_leave_view_search_manager"/>
      <field name="arch" type="xml">
        <xpath expr="//filter[@name='department']" position="after">
          <separator/>
          <filter string="Nghỉ phép cần duyệt" name="my_confirm" domain="[('en_next_approver_ids', '=', uid), ('state', '=', 'confirm')]"/>
        </xpath>
      </field>
    </record>

    <record id="ngs_view_hr_holidays_filter" model="ir.ui.view">
      <field name="name">ngs_view_hr_holidays_filter</field>
      <field name="model">hr.leave</field>
      <field name="inherit_id" ref="hr_holidays.view_hr_holidays_filter"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='employee_id']" position="after">
          <field name="employee_barcode"/>
        </xpath>
      </field>
    </record>

    <record id="hr_leave_view_tree" model="ir.ui.view">
      <field name="inherit_id" ref="hr_holidays.hr_leave_view_tree"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='employee_id']" position="after">
          <field name="en_area_id" optional="hide"/>
        </xpath>
        <field name="message_needaction" position="before">
          <field name="can_approve" invisible="1"/>
        </field>
        <field name="employee_id" position="before">
          <field name="employee_barcode"/>
        </field>
        <button name="action_approve" position="attributes">
          <attribute name="invisible">1</attribute>
        </button>
        <button name="action_validate" position="attributes">
          <attribute name="invisible">1</attribute>
        </button>
        <button name="action_refuse" position="attributes">
          <attribute name="invisible">1</attribute>
          <attribute name="groups"></attribute>
        </button>
        <!-- Commented out for Odoo 18 compatibility - tree structure may have changed -->
        <!-- <xpath expr="//tree" position="inside">
            <header>
                <button string="Duyệt nghỉ phép" type="object" class="btn-primary" name="button_mass_approved" groups="hr.group_hr_manager"/>
            </header>
            <field name="sent_ok" invisible="1"/>
            <field name="approve_ok" invisible="1"/>
            <button string="Gửi duyệt" type="object" class="btn-primary" name="button_to_approve" invisible="state != 'draft' or not sent_ok"/>
            <button string="Duyệt" type="object" class="btn-primary" name="button_approved" invisible="state != 'confirm' or not approve_ok"/>
            <button string="Từ chối" type="object" name="button_refused" invisible="state != 'confirm' or not approve_ok"/>
        </xpath> -->

      </field>
    </record>

    <record id="view_employee_tree" model="ir.ui.view">
      <field name="inherit_id" ref="hr.view_employee_tree"/>
      <field name="priority">100000</field>
      <field name="arch" type="xml">
        <list position="replace">
          <list string="Employees" multi_edit="1" sample="1" js_class="hr_employee_list">
            <field name="en_type_id" optional="show"/>
            <field name="state_hr_employee" optional="show"/>
            <field name="barcode" optional="show"/>
            <field name="name" optional="show"/>
            <field name="job_title" optional="show"/>
            <field name="work_email" optional="show"/>
            <field name="phone" optional="show"/>
            <field name="en_area_id" optional="show"/>
            <field name="en_block_id" optional="show"/>
            <field name="department_id" optional="show"/>
            <field name="en_department_id" optional="show"/>
            <field name="parent_id" optional="hide"/>
            <field name="en_status" optional="show"/>
          </list>
        </list>
      </field>
    </record>
    <record id="view_employee_tree_hr" model="ir.ui.view">
      <field name="inherit_id" ref="view_employee_tree"/>
      <field name="mode">primary</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='en_status']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//field[@name='en_status']" position="after">
          <field name="en_status_hr" optional="show"/>
          <field name="company_id" invisible="1"/>
        </xpath>
      </field>
    </record>

    <record id="form_history_employee" model="ir.ui.view">
      <field name="name">form_history_employee</field>
      <field name="model">hr.employee</field>
      <field name="priority">10000</field>
      <field name="arch" type="xml">
        <form string="Employee" js_class="hr_employee_form" class='o_employee_form_popup'>
          <div class="oe_chatter">
            <field name="message_follower_ids"/>
            <field name="activity_ids"/>
            <field name="message_ids"/>
          </div>
        </form>
      </field>
    </record>

    <record id="view_department_form" model="ir.ui.view">
      <field name="inherit_id" ref="hr.view_department_form"/>
      <field name="arch" type="xml">
        <!-- Thêm field sau company_id -->
        <field name="company_id" position="after">
          <field name="en_os"/>
          <field name="is_support"/>
          <field name="bod"/>
          <field name="block_id" required="not en_os"/>
          <field name="en_project_manager_id"/>
          <field name="no_check_lender"/>
        </field>

        <!-- Thêm field code sau name -->
        <field name="name" position="after">
          <field name="code"/>
        </field>

        <!-- Thêm deputy_manager_id sau manager_id -->
        <field name="manager_id" position="after">
          <field name="deputy_manager_id"/>
        </field>

        <!-- Đổi label của field name -->
        <xpath expr="//field[@name='name']" position="attributes">
          <attribute name="string">Tên Trung tâm/Ban</attribute>
        </xpath>

        <!-- Thêm notebook vào cuối sheet, trước chatter -->
        <xpath expr="//sheet" position="inside">
          <group string="Phòng ban">
            <field name="en_department_ids" nolabel="1"/>
          </group>

          <!-- Comment out for Odoo 18 - Các trường không tồn tại trong mô hình -->
          <!-- <notebook>
            <page string="Nhân sự đang cho mượn">
              <field name="employee_lender_ids" readonly="1">
                <tree>
                  <field name="borrow_department_id" string="Trung tâm đang mượn"/>
                  <field name="employee_id"/>
                  <field name="email"/>
                  <field name="job_position_id"/>
                  <field name="level_id"/>
                  <field name="date_start"/>
                  <field name="date_end"/>
                  <field name="workload" widget="percentage"/>
                  <field name="state"/>
                </tree>
                <form>
                  <sheet>
                    <group>
                      <group>
                        <field name="employee_id"/>
                        <field name="email"/>
                        <field name="department_id" string="Trung tâm của nhân sự"/>
                        <field name="job_position_id"/>
                        <field name="level_id"/>
                      </group>
                      <group>
                        <field name="borrow_department_id" string="Trung tâm đang mượn"/>
                        <field name="date_start"/>
                        <field name="date_end"/>
                        <field name="workload" widget="percentage"/>
                      </group>
                    </group>
                  </sheet>
                </form>
              </field>
            </page>
            <page string="Nhân sự mượn từ trung tâm khác">
              <field name="employee_borrow_ids" readonly="1">
                <tree>
                  <field name="department_id" string="Mượn từ trung tâm"/>
                  <field name="employee_id"/>
                  <field name="email"/>
                  <field name="job_position_id"/>
                  <field name="level_id"/>
                  <field name="date_start"/>
                  <field name="date_end"/>
                  <field name="workload" widget="percentage"/>
                  <field name="state"/>
                </tree>
                <form>
                  <sheet>
                    <group>
                      <group>
                        <field name="employee_id"/>
                        <field name="email"/>
                        <field name="job_position_id"/>
                        <field name="level_id"/>
                      </group>
                      <group>
                        <field name="department_id" string="Mượn từ trung tâm"/>
                        <field name="date_start"/>
                        <field name="date_end"/>
                        <field name="workload" widget="percentage"/>
                      </group>
                    </group>
                  </sheet>
                </form>
              </field>
            </page>
          </notebook> -->
        </xpath>
      </field>
    </record>

    <record id="ngs_view_employee_category_list" model="ir.ui.view">
      <field name="inherit_id" ref="hr.view_employee_category_list"/>
      <field name="arch" type="xml">
        <field name="name" position="after">
          <field name="day_auto_apply"/>
        </field>
      </field>
    </record>

    <!-- Commented out for Odoo 18 compatibility - action may not exist -->
    <!-- <record id="hr_holidays.hr_leave_action_action_approve_department" model="ir.actions.act_window">
        <field name="context">{'hide_employee_name': 1, 'create': 0, 'search_default_my_confirm': 1}</field>
    </record> -->

    <record id="hr_leave_view_form_manager" model="ir.ui.view">
      <field name="mode">extension</field>
      <field name="inherit_id" ref="hr_holidays.hr_leave_view_form_manager"/>
      <field name="arch" type="xml">
        <!-- Comment out for Odoo 18 - employee_ids field không tồn tại -->
        <!-- <field name="employee_ids" position="replace"/>
        <field name="employee_ids" position="attributes">
          <attribute name="required">holiday_type == 'employee'</attribute>
          <attribute name="invisible">holiday_type != 'employee' or (state == 'validate' and employee_id != False)</attribute>
          <attribute name="groups"></attribute>
        </field> -->
        <!-- Comment out for Odoo 18 - Các trường này có thể không tồn tại hoặc đã thay đổi -->
        <!-- <field name="employee_id" position="attributes">
          <attribute name="groups"></attribute>
        </field>
        <field name="holiday_type" position="attributes">
          <attribute name="groups"></attribute>
        </field>
        <field name="mode_company_id" position="attributes">
          <attribute name="groups"></attribute>
        </field>
        <field name="category_id" position="attributes">
          <attribute name="groups"></attribute>
        </field>
        <field name="department_id" position="attributes">
          <attribute name="groups"></attribute>
        </field>
        <field name="name" position="attributes">
          <attribute name="readonly">state in ['confirm','validate']</attribute>
        </field> -->
      </field>
    </record>

    <record id="hr_kanban_view_employees" model="ir.ui.view">
      <field name="inherit_id" ref="hr.hr_kanban_view_employees"/>
      <field name="arch" type="xml">
        <field name="user_partner_id" position="after">
          <field name="department_id"/>
          <field name="mobile_phone"/>
        </field>

        <xpath expr="//templates//div[hasclass('oe_kanban_global_click')]//ul//li[hasclass('o_force_ltr')]" position="replace">
          <li t-if="record.mobile_phone.raw_value" class="o_force_ltr">
            <field name="mobile_phone"/>
          </li>
        </xpath>
        <xpath expr="//templates//div[hasclass('oe_kanban_global_click')]//ul" position="inside">
          <li t-if="record.department_id" class="o_force_ltr">
            <field name="department_id"/>
          </li>
        </xpath>
      </field>
    </record>

    <record id="hr.open_view_employee_list_my" model="ir.actions.act_window">
      <field name="res_model">hr.employee</field>
      <field name="view_mode">tree,kanban,form,activity</field>
      <field name="domain">[('is_hidden', '=', False)]</field>
    </record>

    <record id="view_employee_form" model="ir.ui.view">
      <field name="name">view_employee_form</field>
      <field name="model">hr.employee</field>
      <field name="inherit_id" ref="hr.view_employee_form"/>
      <field name="arch" type="xml">

        <field name="mobile_phone" position="after">
          <field name="state_hr_employee"/>
          <field name="en_type_id" domain="['|', ('internal_ok', '=', True), ('is_intern', '=', True)]" required="not is_hidden" options="{'no_create': True,'no_open': True}"/>
          <field name="barcode" position="move"/>
        </field>
        <field name="work_location_id" position="after">
          <field name="train_ctv" invisible="1"/>
          <field name="job_code_id"/>
          <field name="level_id"/>
          <field name="sub_level_id"/>
          <field name="pay_grade_id"/>
          <field name="salary_grade"/>
        </field>
        <field name="address_home_id" position="after">
          <field name="notebook_bhxh"/>
          <field name="tax_code"/>
          <field name="date_tax"/>
          <field name="place_tax"/>
        </field>
        <field name="children" position="after">
          <field name="depend_persion_id">
            <list editable="bottom">
              <field name="relationship"/>
              <field name="full_name"/>
              <field name="date_of_birth"/>
              <field name="people_id" optional="hide"/>
              <field name="reduce" optional="hide"/>
              <field name="reduce_from" optional="hide"/>
              <field name="reduce_to" optional="hide"/>
              <field name="note"/>
            </list>
          </field>
        </field>
        <field name="work_email" position="after">
          <field name="en_internal_ok" invisible="1"/>
          <field name="is_hidden" invisible="1"/>
          <field name="en_area_id" required="en_internal_ok" options="{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}"/>
          <field name="en_block_id" required="en_internal_ok" options="{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}"/>
          <field name="department_id" position="move" options="{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}"/>
          <field name="en_department_id" options="{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}"/>
        </field>
        <field name="country_of_birth" position="after">
          <field name="regular_address" required="en_internal_ok"/>
        </field>
        <field name="identification_id" position="after">
          <field name="cccd_date" required="en_internal_ok"/>
          <field name="cccd_place" required="en_internal_ok"/>
        </field>
        <xpath expr="//field[@name='identification_id']" position="attributes">
          <attribute name="required">en_internal_ok == True</attribute>
        </xpath>
        <xpath expr="//field[@name='gender']" position="attributes">
          <attribute name="required">en_internal_ok == True</attribute>
        </xpath>
        <xpath expr="//field[@name='birthday']" position="attributes">
          <attribute name="required">en_internal_ok == True</attribute>
        </xpath>
        <xpath expr="//field[@name='category_ids']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <field name="employee_type" position="after">
          <field name="shift"/>
          <field name="has_child_start"/>
          <field name="has_child_end"/>
          <field name="check_timesheet_before_checkout"/>
          <field name="check_representative"/>
        </field>
        <group name="active_group" position="after">
          <group string="Khóa sổ">
            <field name="lock_create_timesheet"/>
            <field name="lock_create_timesheet_exp"/>
            <field name="lock_approve_timesheet"/>
            <field name="lock_approve_timesheet_exp"/>
          </group>
        </group>
        <field name="employee_type" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="barcode" position="attributes">
          <attribute name="required">en_internal_ok == True</attribute>
        </field>
        <field name="department_id" position="attributes">
          <attribute name="required">is_hidden == False</attribute>
          <attribute name="domain">[('block_id', '=?', en_block_id), '|', ('company_id', '=', False), ('company_id', '=', company_id)]</attribute>
          <attribute name="options">{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}</attribute>
        </field>
        <field name="work_email" position="attributes">
          <attribute name="required">is_hidden == False</attribute>
        </field>
        <field name="parent_id" position="after">
          <field name="job_id" position="move"/>
          <field name="en_level_id" required="1" options="{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}"/>
          <field name="en_technique" invisible="1"/>
          <field name="role_ids" widget="many2many_tags" options="{'no_create': True, 'no_create_edit': True}" invisible="1"/>
          <field name="en_date_start" required="not is_hidden"/>
        </field>
        <field name="job_id" position="attributes">
          <attribute name="required">1</attribute>
          <attribute name="options">{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}</attribute>
        </field>
        <field name="address_id" position="before">
          <field name="mobile_phone" position="move"/>
          <field name="work_phone" position="move"/>
          <field name="parent_id" position="move"/>
          <!--                    <field name="leave_manager_id" position="move"/>-->
          <field name="coach_id" position="move"/>
          <field name="company_id" position="move"/>
        </field>
        <field name="address_id" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="address_home_id" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="address_home_id" position="before">
          <field name="address_current" required="en_internal_ok"/>
        </field>
        <field name="bank_account_id" position="after">
          <field name="res_partner_bank_ids">
            <list>
              <field name="bank_id"/>
              <field name="acc_number"/>
            </list>
          </field>
        </field>
        <field name="parent_id" position="after">
          <field name="indirect_manager"/>
        </field>
        <header position="inside">
          <button name="button_resource_account_report_wizard_act" groups="ngsd_base.group_tpvh,ngsd_base.group_gdkndu,ngsd_base.group_tptc,ngsd_base.group_pm,ngsd_base.group_qam"
            string="Thông tin nguồn lực" type="object"/>
          <button name="en_button_layoff" string="Nghỉ việc" invisible="en_status == 'inactive'" groups="ngsd_base.group_tpvh,ngsd_base.group_gdkndu,ngsd_base.group_userhr" type="object"/>
          <button name="button_show_history" string="Lịch sử" type="object"/>
          <button name="button_user_reset_password" string="Gửi email đặt mặt khẩu" groups="base.group_system,ngsd_base.group_userhr" type="object"/>
          <button name="button_user_reset_login_failed_number" string="Mở khóa" groups="base.group_system,ngsd_base.group_userhr" type="object"/>
          <field name="en_status" widget="statusbar"/>
        </header>
        <header position="attributes">
          <attribute name="invisible">context.get('invisible_header_hr_employee', False)</attribute>
        </header>
        <header position="after">
          <header>
            <field name="en_status_hr" widget="statusbar" invisible="not context.get('invisible_header_hr_employee', False)" class="oe_right"/>
          </header>
        </header>
        <group name="departure" position="before">
          <group string="Thông tin đào tạo/thử việc">
            <field name="date_start_training"/>
            <field name="date_end_training"/>
            <field name="date_start_probation"/>
            <field name="date_end_probation"/>
          </group>
        </group>
        <group name="departure" position="after">
          <group string="Thông tin phụ cấp">
            <field name="salary_gross_offer"/>
            <field name="salary_probation"/>
            <field name="salary_basic"/>
            <field name="lunch_allowance"/>
            <field name="travel_allowance"/>
            <field name="salary_temporary_effective"/>
            <field name="total_new_income"/>
            <field name="total_old_income"/>
            <field name="pti_insurance_level"/>
          </group>
        </group>
        <group name="departure" position="attributes">
          <attribute name="invisible">False</attribute>
          <attribute name="string">Thời gian công tác</attribute>
        </group>
        <field name="departure_reason_id" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="departure_description" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="mobile_phone" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <group name="identification_group" position="attributes">
          <attribute name="invisible">1</attribute>
        </group>
        <group name="payroll_group" position="attributes">
          <attribute name="invisible">1</attribute>
        </group>
        <group name="application_group" position="attributes">
          <attribute name="invisible">1</attribute>
        </group>
        <field name="departure_date" position="attributes">
          <attribute name="readonly">1</attribute>
          <attribute name="force_save">1</attribute>
        </field>
        <field name="departure_date" position="before">
          <field name="official_working_day"/>
          <field name="seniority_date"/>
          <field name="rest_state"/>
        </field>
        <field name="private_email" position="attributes">
          <attribute name="string">Email cá nhân</attribute>
          <attribute name="readonly">0</attribute>
        </field>
        <field name="phone" position="attributes">
          <attribute name="readonly">0</attribute>
        </field>
        <field name="departure_date" position="after">
          <field name="en_text_off" readonly="1" force_save="1"/>
          <label for="en_day_layoff_from" string="Ngày nghỉ dài hạn"/>
          <div class="o_row">
            <field name="en_day_layoff_from" widget="daterange" nolabel="1" class="oe_inline" options="{'related_end_date': 'en_day_layoff_to'}" readonly="1" force_save="1"/>
            <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/>
            <field name="en_day_layoff_to" widget="daterange" nolabel="1" class="oe_inline" options="{'related_start_date': 'en_day_layoff_from'}" readonly="1" force_save="1"/>
          </div>
          <field name="en_text_layoff" readonly="1" force_save="1"/>
        </field>
        <xpath expr="//button[@name='%(hr.plan_wizard_action)d']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//div[@name='div_km_home_work']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//label[@for='km_home_work']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//page[@name='personal_information']//group//group[7]" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//page[@name='personal_information']" position="attributes">
          <attribute name="invisible">en_internal_ok == False</attribute>
          <attribute name="groups">ngsd_base.group_cbf,ngsd_base.group_cbf_hcm</attribute>
        </xpath>
        <xpath expr="//page[@name='public']" position="attributes">
          <attribute name="groups">ngsd_base.group_cbf,ngsd_base.group_cbf_hcm</attribute>
        </xpath>
        <xpath expr="//page[@name='hr_settings']" position="attributes">
          <attribute name="groups">ngsd_base.group_cbf,ngsd_base.group_cbf_hcm</attribute>
        </xpath>
        <field name="tz" position="attributes">
          <attribute name="readonly">1</attribute>
          <attribute name="force_save">1</attribute>
        </field>
        <div name="button_box" position="inside">
          <button class="oe_stat_button" type="object" name="button_timesheet_general" icon="fa-calendar">
            <div class="o_stat_info">
              <span class="o_stat_text">Bảng tổng hợp chấm công</span>
            </div>
          </button>
        </div>
        <field name="coach_id" position="attributes">
          <attribute name="invisible">1</attribute>
        </field>
        <field name="parent_id" position="attributes">
          <attribute name="string">Quản lý trực tiếp</attribute>
        </field>
      </field>
    </record>

    <record id="view_employee_form_hr" model="ir.ui.view">
      <field name="name">view_employee_form_hr</field>
      <field name="model">hr.employee</field>
      <field name="priority">10000</field>
      <field name="inherit_id" ref="hr.view_employee_form"/>
      <field name="mode">primary</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='en_status']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//field[@name='en_status']" position="after">
          <field name="en_status_hr" widget="statusbar"/>
        </xpath>
        <xpath expr="//field[@name='bank_account_id']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//div[@class='oe_chatter']" position="replace"/>
        <xpath expr="//page/group/group/field[@name='first_contract_date']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
      </field>
    </record>

    <record id="view_employee_form_hr_hidden" model="ir.ui.view">
      <field name="name">view_employee_form_hr</field>
      <field name="model">hr.employee</field>
      <field name="priority">100000</field>
      <field name="inherit_id" ref="view_employee_form_hr"/>
      <field name="mode">primary</field>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='en_type_id']" position="replace">
          <field name="en_type_id" domain="[('is_hidden', '=', True)]" required="1"/>
        </xpath>
        <xpath expr="//field[@name='department_id']" position="replace">
          <field name="department_id" required="1" domain="[('block_id', '=?', en_block_id), '|', ('company_id', '=', False), ('company_id', '=', company_id)]"/>
        </xpath>
        <xpath expr="//field[@name='en_area_id']" position="replace">
          <field name="en_area_id" required="1"/>
        </xpath>
        <xpath expr="//field[@name='en_block_id']" position="replace">
          <field name="en_block_id" required="1"/>
          <field name="company_id" invisible="1"/>
        </xpath>
        <xpath expr="//page[@name='public']" position="replace">
        </xpath>
        <xpath expr="//page[@name='personal_information']" position="replace">
        </xpath>
      </field>
    </record>

    <record id="resume_line_view_form_inherit" model="ir.ui.view">
      <field name="name">hr.resume.line.form.inherit</field>
      <field name="model">hr.resume.line</field>
      <field name="inherit_id" ref="hr_skills.resume_line_view_form"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='line_type_id']" position="attributes">
          <attribute name="options">{'no_create': True, 'no_create_edit': True, 'no_quick_create': True}</attribute>
        </xpath>
        <xpath expr="//field[@name='display_type']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <xpath expr="//field[@name='line_type_id']" position="after">
          <field name="specialized" invisible="hr_resume_type != 'edu'" required="hr_resume_type == 'edu'"/>
          <field name="hr_resume_type" invisible="1"/>
          <field name="name_project" invisible="hr_resume_type != 'exp'"/>
          <field name="domain_project" invisible="hr_resume_type != 'exp'"/>
        </xpath>
        <xpath expr="//field[@name='name']" position="attributes">
          <attribute name="required">0</attribute>
          <attribute name="required">hr_resume_type != 'exp'</attribute>
        </xpath>
        <xpath expr="//field[@name='date_start']" position="attributes">
          <attribute name="required">0</attribute>
        </xpath>
        <xpath expr="//field[@name='date_end']" position="after">
          <field name="graduation_year" invisible="hr_resume_type != 'edu'"/>
          <field name="service_provided" invisible="hr_resume_type != 'exp'"/>
          <field name="position_responsibility" invisible="hr_resume_type != 'exp'"/>
        </xpath>
      </field>
    </record>

    <record id="hr_resume_line_type_tree_view_inherit" model="ir.ui.view">
      <field name="name">hr.resume.line.type.tree.view.inherit</field>
      <field name="model">hr.employee</field>
      <field name="inherit_id" ref="hr_skills.hr_employee_view_form"/>
      <field name="arch" type="xml">
        <xpath expr="//field[@name='resume_line_ids']//tree//field[@name='name']" position="after">
          <field name="hr_resume_type" invisible="1"/>
          <field name="name_project"/>
          <field name="domain_project"/>
          <field name="service_provided"/>
          <field name="position_responsibility"/>
        </xpath>
      </field>
    </record>

    <record id="ngsd_view_employee_filter" model="ir.ui.view">
      <field name="inherit_id" ref="hr.view_employee_filter"/>
      <field name="priority">10000</field>
      <field name="arch" type="xml">
        <filter name="message_needaction" position="attributes">
          <attribute name="invisible">1</attribute>
        </filter>
        <filter name="is_absent" position="attributes">
          <attribute name="invisible">1</attribute>
        </filter>
        <filter name="inactive" position="after">
          <separator/>
          <filter string="Nội bộ" name="en_type_internal" domain="[('en_type_id.en_internal', '=', True)]"/>
          <filter string="Outsource" name="en_type_outsource" domain="[('en_type_id.name', '=', 'OS')]"/>
        </filter>
      </field>
    </record>

    <record id="ngsd_view_employee_filter_hr" model="ir.ui.view">
      <field name="inherit_id" ref="hr.view_employee_filter"/>
      <field name="priority">40000</field>
      <field name="mode">primary</field>
      <field name="arch" type="xml">
        <filter name="semi-inactive" position="attributes">
          <attribute name="string">Nghỉ không lương</attribute>
          <attribute name="domain">[('en_status_hr', '=', 'semi-inactive')]</attribute>
        </filter>
        <filter name="inactive" position="attributes">
          <attribute name="domain">[('en_status_hr', '=', 'inactive'), ('active', 'in', [True, False])]</attribute>
        </filter>
        <filter name="active" position="attributes">
          <attribute name="domain">[('en_status_hr', '=', 'active')]</attribute>
        </filter>
        <filter name="semi-inactive" position="after">
          <filter string="Nghỉ thai sản" name="filter_maternity-leave" domain="[('en_status_hr', '=', 'maternity-leave')]"/>
        </filter>
      </field>
    </record>

    <record model="ir.actions.server" id="action_noti_not_target_quarter">
      <field name="name">Weekly Update Remind</field>
      <field name="model_id" ref="crm.model_crm_lead"/>
      <field name="type">ir.actions.server</field>
      <field name="state">code</field>
      <field name="code">action = model.check_x_support_history()</field>
    </record>
    <record model="ir.actions.server" id="action_noti_not_target_year">
      <field name="name">Thông báo Chưa đạt chỉ tiêu năm</field>
      <field name="model_id" ref="hr.model_hr_employee"/>
      <field name="type">ir.actions.server</field>
      <field name="state">code</field>
      <field name="code">action = model.noti_not_target_year()</field>
    </record>
    <record id="hr_employee_layoff_wizard_form" model="ir.ui.view">
      <field name="model">hr.employee.layoff.wizard</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <div class="oe_title">
              <h1>
                <field name="employee_id" readonly="1"/>
              </h1>
            </div>
            <field name="state" required="1" widget="radio" options="{'horizontal': true}"/>
            <group invisible="state != 'inactive'" colspan="12">
              <field name="date" required="state == 'inactive'"/>
              <field name="text"/>
            </group>
            <group invisible="state == 'inactive'" colspan="12">
              <div class="o_td_label">
                <label for="day_layoff_from" string="Ngày nghỉ không lương" invisible="state != 'semi-inactive'"/>
                <label for="day_layoff_from" string="Ngày nghỉ thai sản" invisible="state != 'maternity-leave'"/>
              </div>

              <div class="o_row">
                <field name="day_layoff_from" required="state != 'inactive'" nolabel="1" class="oe_inline"/>
                <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/>
                <field name="day_layoff_to" required="state != 'inactive'" nolabel="1" class="oe_inline"/>
              </div>
              <field name="text_layoff"/>
            </group>
          </sheet>
          <footer>
            <button name="do" string="Xác nhận" type="object" class="btn-primary"/>
            <button string="Hủy" class="btn-secondary" special="cancel"/>
          </footer>
        </form>
      </field>
    </record>

    <record id="hr_employee_layoff_wizard_act" model="ir.actions.act_window">
      <field name="res_model">hr.employee.layoff.wizard</field>
      <field name="view_mode">form</field>
      <field name="target">new</field>
    </record>

    <record id="timesheet_general_view_tree" model="ir.ui.view">
      <field name="name">timesheet.general.view.tree</field>
      <field name="model">timesheet.general</field>
      <field name="arch" type="xml">
        <list string="" editable="bottom">
          <field name="date"/>
          <field name="employee_id"/>
          <field name="type"/>
          <field name="total_time"/>
        </list>
      </field>
    </record>

    <record id="timesheet_general_view_calendar" model="ir.ui.view">
      <field name="name">timesheet.general.view.calendar</field>
      <field name="model">timesheet.general</field>
      <field name="arch" type="xml">
        <calendar string="" js_class="timesheet_general" color="color" date_start="date" mode="month" create="0" delete="0">
          <field name="text_content" nolabel="1" invisible="type in ('leave_approved',)"/>
          <field name="color" invisible="1"/>
          <field name="type" invisible="1"/>
        </calendar>
      </field>
    </record>

    <record id="timesheet_general_view_form" model="ir.ui.view">
      <field name="name">timesheet.general.view.form</field>
      <field name="model">timesheet.general</field>
      <field name="arch" type="xml">
        <form string="">
          <sheet>
            <group>
              <field name="date"/>
              <field name="employee_id"/>
              <field name="type"/>
              <field name="total_time"/>
              <field name="color" invisible="1"/>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record id="timesheet_general_action_server" model="ir.actions.server">
      <field name="name">Bảng tổng hợp chấm công</field>
      <field name="model_id" ref="ngsd_base.model_timesheet_general"/>
      <field name="binding_model_id" eval="False"/>
      <field name="state">code</field>
      <field name="code">
        env['timesheet.general'].init_data(user.employee_id.id)
        action = {
        'type': 'ir.actions.act_window',
        'name': 'Bảng tổng hợp chấm công',
        'res_model': 'timesheet.general',
        'views': [[False, 'calendar'], [False, 'list']],
        'domain': [('employee_id', '=', user.employee_id.id)],
        'target': 'self',
        'context': {'create': 0, 'edit': 0, 'delete': 0}
        }
      </field>
    </record>
    <record id="change_lock_license_create_action_server" model="ir.actions.server">
      <field name="name">Thay đổi ngày khóa khai timesheet</field>
      <field name="model_id" ref="hr.model_hr_employee"/>
      <field name="binding_model_id" ref="hr.model_hr_employee"/>
      <field name="state">code</field>
      <field name="code">
        action = {
        'type': 'ir.actions.act_window',
        'name': 'Thay đổi ngày khóa khai timesheet',
        'res_model': 'change.lock.license',
        'view_mode': 'form',
        'target': 'new',
        'context': {
        'default_employee_ids': records.ids,
        'default_type': 'create',
        },
        'views': [[False, 'form']],
        }
      </field>
      <field name="groups_id" eval="[(4, ref('ngsd_base.ngs_lock_timesheet_group'))]"/>
    </record>
    <record id="change_lock_license_approve_action_server" model="ir.actions.server">
      <field name="name">Thay đổi ngày khóa duyệt timesheet</field>
      <field name="model_id" ref="hr.model_hr_employee"/>
      <field name="binding_model_id" ref="hr.model_hr_employee"/>
      <field name="state">code</field>
      <field name="code">
        action = {
        'type': 'ir.actions.act_window',
        'name': 'Thay đổi ngày khóa duyệt timesheet',
        'res_model': 'change.lock.license',
        'view_mode': 'form',
        'target': 'new',
        'context': {
        'default_employee_ids': records.ids,
        'default_type': 'approve',
        },
        'views': [[False, 'form']],
        }
      </field>
      <field name="groups_id" eval="[(4, ref('ngsd_base.ngs_lock_timesheet_group'))]"/>
    </record>

    <record id="menu_timesheet_general_report" model="ir.ui.menu">
      <field name="name">Bảng tổng hợp chấm công</field>
      <field name="action" ref="timesheet_general_action_server"/>
      <field name="sequence">80</field>
    </record>

    <record id="salary_grade_tree" model="ir.ui.view">
      <field name="name">salary.grade.tree</field>
      <field name="model">salary.grade</field>
      <field name="arch" type="xml">
        <list editable="top">
          <field name="name"/>
        </list>
      </field>
    </record>
    <record id="pay_grade_tree" model="ir.ui.view">
      <field name="name">pay.grade.tree</field>
      <field name="model">pay.grade</field>
      <field name="arch" type="xml">
        <list editable="top">
          <field name="name"/>
        </list>
      </field>
    </record>

    <record id="open_view_employee_list_my_hr" model="ir.actions.act_window">
      <field name="name">Nhân viên</field>
      <field name="res_model">hr.employee</field>
      <field name="context">{'chat_icon': True}</field>
      <field name="view_id" eval="False"/>
      <field name="search_view_id" ref="ngsd_view_employee_filter_hr"/>
      <field name="view_mode">tree,kanban,form,activity</field>
      <field name="domain">[('is_hidden', '=', False)]</field>
      <field name="view_ids"
        eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'list', 'view_id': ref('view_employee_tree_hr')}),
                          (0, 0, {'view_mode': 'kanban', 'view_id': False}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_employee_form_hr')}),
                          (0, 0, {'view_mode': 'activity', 'view_id': False}),
                          ]"/>

    </record>

    <record id="open_view_employee_list_my_hr_hidden" model="ir.actions.act_window">
      <field name="name">Nhân viên</field>
      <field name="res_model">hr.employee</field>
      <field name="context">{'chat_icon': True, 'hidden': True}</field>
      <field name="view_id" eval="False"/>
      <field name="search_view_id" ref="ngsd_view_employee_filter_hr"/>
      <field name="view_mode">tree,kanban,form,activity</field>
      <field name="domain">[('is_hidden', '=', True)]</field>
      <field name="view_ids"
        eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'list', 'view_id': ref('view_employee_tree_hr')}),
                          (0, 0, {'view_mode': 'kanban', 'view_id': False}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_employee_form_hr_hidden')}),
                          (0, 0, {'view_mode': 'activity', 'view_id': False}),
                          ]"/>

    </record>

</odoo>